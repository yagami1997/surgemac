# > hulo.list - Chinese Social Media Rules
# > This ruleset contains rules for Chinese social media platforms
# > Included: Zhihu (知乎) and Xiaohongshu (小红书/RED)
# > Use this ruleset to route traffic through proxy for better performance

# ========================================
# Zhihu (知乎) - Q&A Community Platform
# ========================================
# China's largest question-and-answer platform
# CRITICAL: IP display control for answers/comments

# > User-Agent Rules
USER-AGENT,*zhihu*
USER-AGENT,zhihu*
USER-AGENT,*ZhihuHybrid*

# > Main Domain Rules
DOMAIN-SUFFIX,zhihu.com  # Main domain (covers all subdomains including www, api, link, etc.)
DOMAIN-KEYWORD,zhihu

# > API & Backend Domains (CRITICAL - these handle answer/comment submissions)
DOMAIN,api.zhihu.com  # Main API endpoint
DOMAIN,www.zhihu.com  # Web version
DOMAIN,zhuanlan.zhihu.com  # Zhihu Column (articles)
DOMAIN,link.zhihu.com  # Link redirector
DOMAIN,lens.zhihu.com  # Lens service
DOMAIN,sugar.zhihu.com  # Sugar service (ads/recommendations)

# > CDN & Media Domains (CRITICAL - image/video content)
DOMAIN-SUFFIX,zhimg.com  # Primary image CDN (covers pic1.zhimg.com, pic2.zhimg.com, etc.)
DOMAIN-SUFFIX,zhihu-web-analytics.zhihu.com  # Analytics
DOMAIN-KEYWORD,zhimg  # Catch all image CDN variants
DOMAIN-KEYWORD,video.zhihu  # Video CDN
DOMAIN-KEYWORD,vdn.zhihu  # Video delivery network

# > Static & Resources
DOMAIN,static.zhihu.com  # Static resources
DOMAIN,static-legacy.zhihu.com  # Legacy static resources

# > Core Zhihu Server IPs (API servers)
# Note: Zhihu uses distributed CDN heavily, domain-based rules are primary
IP-CIDR,118.89.204.198/32,no-resolve  # Main API server
IP-CIDR,103.41.167.234/32,no-resolve  # Backup API server

# NOTE: Zhihu heavily relies on third-party CDN services (Alibaba Cloud, Tencent Cloud)
# Domain-based rules are more reliable for IP location control than IP-CIDR rules

# ========================================
# Xiaohongshu (小红书) - Lifestyle Sharing Platform
# ========================================
# Also known as RED, a lifestyle and social e-commerce platform
# CRITICAL: IP display control for posts/comments

# > User-Agent Rules
USER-AGENT,*xiaohongshu*
USER-AGENT,xiaohongshu*
USER-AGENT,*redbook*
USER-AGENT,*RED*

# > Main Domain Rules
DOMAIN-SUFFIX,xiaohongshu.com  # Main domain (covers all subdomains)
DOMAIN-SUFFIX,xhslink.com  # Short links
DOMAIN-KEYWORD,xiaohongshu

# > API & Backend Domains (CRITICAL - these handle post submissions)
DOMAIN,edith.xiaohongshu.com  # Main API endpoint
DOMAIN,fe-api.xiaohongshu.com  # Frontend API
DOMAIN,api.xiaohongshu.com  # General API
DOMAIN,customer.xiaohongshu.com  # Customer service API
DOMAIN,referee.xiaohongshu.com  # Referral system
DOMAIN,ads.xiaohongshu.com  # Advertising API

# > CDN & Media Domains (CRITICAL - image/video uploads)
DOMAIN-SUFFIX,xhscdn.com  # Primary CDN
DOMAIN-SUFFIX,xhscdn.net  # CDN backup
DOMAIN-SUFFIX,xhsstatic.com  # Static resources
DOMAIN,ci.xiaohongshu.com  # Image processing/upload
DOMAIN,picasso.xiaohongshu.com  # Image service
DOMAIN-KEYWORD,xhscdn  # Catch all CDN variants
DOMAIN-KEYWORD,fe-video-qc  # Video CDN
DOMAIN-KEYWORD,sns-video  # Social video CDN
DOMAIN-KEYWORD,sns-img-qc  # Social image CDN

# > Web & Frontend Domains
DOMAIN,www.xiaohongshu.com  # Web version
DOMAIN,m.xiaohongshu.com  # Mobile web

# > IMPORTANT: Remove most IP-CIDR rules - they may conflict with proxy routing
# Only keep essential IPs that are confirmed Xiaohongshu exclusive
# Most CDN IPs are shared with other services and should not be force-routed

# > Core Xiaohongshu Server IPs (API servers)
IP-CIDR,223.109.0.0/16,no-resolve  # Primary server range
IP-CIDR,103.41.167.0/24,no-resolve  # Backup server

# > IPv6 Support
IP-CIDR6,2402:4e00:1200:ed00:0:9089:6dac:96b6/128,no-resolve

# NOTE: CDN IP ranges removed - they are shared infrastructure and may cause
# routing conflicts. Domain-based rules are more reliable for IP location control.
