# ============================================
# Messenger - Global IM & Chat Applications
# ============================================
# Strategy Group: Messenger
# Purpose: Route all instant messaging and chat app traffic
# Coverage: Discord, Telegram, WhatsApp, Signal, Line, Slack,
#           Element/Matrix, Viber, Zalo, Keybase, Mattermost,
#           Session, Threema, Wire, Rocket.Chat
# Node Requirement: Stable JP (recommended: Flower JP Premium2)
# Note: Supersedes discord.list and ruleset/Telegram.list
# ============================================

# ========================================
# Discord
# ========================================

USER-AGENT,*Discord*
USER-AGENT,Discord*
DOMAIN,discord.com
DOMAIN,discordapp.com
DOMAIN,discord.gg
DOMAIN,discord.media
DOMAIN,discordapp.net
DOMAIN-SUFFIX,discord.com
DOMAIN-SUFFIX,discordapp.com
DOMAIN-SUFFIX,discordapp.net
DOMAIN-SUFFIX,discord.gg
DOMAIN-SUFFIX,discord.media
DOMAIN-SUFFIX,dis.gd
DOMAIN-SUFFIX,discordstatus.com
DOMAIN-KEYWORD,discord

# Discord voice server IP ranges
IP-CIDR,66.22.196.0/22,no-resolve
IP-CIDR,66.22.200.0/21,no-resolve
IP-CIDR,66.22.208.0/20,no-resolve
IP-CIDR,66.22.224.0/20,no-resolve
IP-CIDR,66.22.240.0/21,no-resolve
IP-CIDR,66.22.248.0/22,no-resolve

# ========================================
# Telegram
# ========================================

DOMAIN-SUFFIX,cdn-telegram.org
DOMAIN-SUFFIX,graph.org
DOMAIN-SUFFIX,legra.ph
DOMAIN-SUFFIX,t.me
DOMAIN-SUFFIX,telegra.ph
DOMAIN-SUFFIX,telegram.dog
DOMAIN-SUFFIX,telegram.me
DOMAIN-SUFFIX,telegram.org
DOMAIN-SUFFIX,telegram.space
DOMAIN-SUFFIX,telesco.pe
DOMAIN-SUFFIX,tg.dev
DOMAIN-SUFFIX,tx.me
DOMAIN-SUFFIX,tdesktop.com
DOMAIN-SUFFIX,telega.one
DOMAIN-KEYWORD,telegram

# Telegram IP ranges
IP-CIDR,5.28.195.1/32,no-resolve
IP-CIDR,5.28.195.2/32,no-resolve
IP-CIDR,91.105.192.0/23,no-resolve
IP-CIDR,91.108.4.0/22,no-resolve
IP-CIDR,91.108.8.0/21,no-resolve
IP-CIDR,91.108.16.0/21,no-resolve
IP-CIDR,91.108.56.0/22,no-resolve
IP-CIDR,95.161.64.0/20,no-resolve
IP-CIDR,149.154.160.0/20,no-resolve
IP-CIDR,185.76.151.0/24,no-resolve
IP-CIDR6,2001:67c:4e8::/48,no-resolve
IP-CIDR6,2001:b28:f23c::/48,no-resolve
IP-CIDR6,2001:b28:f23d::/48,no-resolve
IP-CIDR6,2001:b28:f23f::/48,no-resolve
IP-CIDR6,2a0a:f280::/32,no-resolve

# ========================================
# WhatsApp
# ========================================

USER-AGENT,WhatsApp*
DOMAIN-SUFFIX,whatsapp.com
DOMAIN-SUFFIX,whatsapp.net
DOMAIN-SUFFIX,whatsapp.org
DOMAIN-SUFFIX,wa.me
DOMAIN-SUFFIX,wamessage.com
DOMAIN-KEYWORD,whatsapp

# ========================================
# Signal
# ========================================

DOMAIN-SUFFIX,signal.org
DOMAIN-SUFFIX,signal.art
DOMAIN-SUFFIX,signalmessenger.org
DOMAIN-SUFFIX,signal.technology
DOMAIN-SUFFIX,whispersystems.org
DOMAIN-SUFFIX,sfu.voip.signal.org
DOMAIN-KEYWORD,signal

# ========================================
# Line
# ========================================

USER-AGENT,Line*
DOMAIN-SUFFIX,line.me
DOMAIN-SUFFIX,line-apps.com
DOMAIN-SUFFIX,line-scdn.net
DOMAIN-SUFFIX,linecorp.com
DOMAIN-SUFFIX,line.naver.jp
DOMAIN-KEYWORD,line-apps

# ========================================
# Slack
# ========================================

USER-AGENT,Slack*
DOMAIN-SUFFIX,slack.com
DOMAIN-SUFFIX,slack-edge.com
DOMAIN-SUFFIX,slack-msgs.com
DOMAIN-SUFFIX,slack-files.com
DOMAIN-SUFFIX,slack-core.com
DOMAIN-SUFFIX,slack-imgs.com
DOMAIN-SUFFIX,slack-redir.com
DOMAIN-SUFFIX,slack-redir.net
DOMAIN-SUFFIX,slackb.com
DOMAIN-KEYWORD,slack

# ========================================
# Element / Matrix
# ========================================

DOMAIN-SUFFIX,element.io
DOMAIN-SUFFIX,matrix.org
DOMAIN-SUFFIX,matrix.to
DOMAIN-SUFFIX,riot.im
DOMAIN-SUFFIX,modular.im
DOMAIN-KEYWORD,matrix

# ========================================
# Viber
# ========================================

USER-AGENT,Viber*
DOMAIN-SUFFIX,viber.com
DOMAIN-SUFFIX,viber.ga
DOMAIN-SUFFIX,viber.one
DOMAIN-SUFFIX,viber.it
DOMAIN-KEYWORD,viber

# ========================================
# Zalo
# ========================================

DOMAIN-SUFFIX,zalo.me
DOMAIN-SUFFIX,zalo.vn
DOMAIN-SUFFIX,zaloapp.com
DOMAIN-KEYWORD,zalo

# ========================================
# Keybase
# ========================================

DOMAIN-SUFFIX,keybase.io
DOMAIN-SUFFIX,keybase.pub
DOMAIN-KEYWORD,keybase

# ========================================
# Mattermost
# ========================================

DOMAIN-SUFFIX,mattermost.com
DOMAIN-SUFFIX,mattermost.org
DOMAIN-KEYWORD,mattermost

# ========================================
# Session
# ========================================

DOMAIN-SUFFIX,getsession.org
DOMAIN-SUFFIX,session.io
DOMAIN-KEYWORD,getsession

# ========================================
# Threema
# ========================================

DOMAIN-SUFFIX,threema.ch
DOMAIN-SUFFIX,threema.id
DOMAIN-KEYWORD,threema

# ========================================
# Wire
# ========================================

DOMAIN-SUFFIX,wire.com
DOMAIN-SUFFIX,wire.community
DOMAIN-KEYWORD,wire.com

# ========================================
# Rocket.Chat
# ========================================

DOMAIN-SUFFIX,rocket.chat
DOMAIN-SUFFIX,rocketcdn.me
DOMAIN-KEYWORD,rocket.chat
